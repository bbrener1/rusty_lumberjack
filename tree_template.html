<head>
  <style>
      #treeContainer {
        height:2000px;
        width:2000px;
        position:absolute;
        min-width:60%;
        max-width:100%;
        min-height:100%;
      }
      .node_container {
        z-index:1;
        background: white;
        opacity: 1;
        border: 1px solid gray;
        overflow:auto;
        position:absolute;
        max-width:300px;
        transform: translate(-50%,-50%);

      }

      .node_container:hover {

        transform: translate(-50%,-50%) scale(2);
        z-index:2;
      }

      .node_header{
        float:left;
        position:absolute;
        padding:3%;
        width:10%;
        height:84%;
        writing-mode:vertical-rl;
        margin:auto;
        text-align:center;
        transform:rotate(180deg);
      }

      .connection {
        stroke:black;
        z-index:-1;
      }
      .sister_map {
        float:right;
        margin:auto;
        height:100%;
        max-width:84%;
      }
      .score_map {
        float:right;
        margin:auto;
        height:100%;
        max-width:84%;
      }
      .decoration_type {
        position:fixed;
        right:0%;
        width:10%;
      }
    </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $(document).ready(
      function() {
        insertNodes();
        insertConnections();
        decorateNodesSister();
      });

    function insertNodes() {
      console.log(treeCoordinates);
      let [height,width] = treeCoordinates[0];
      width *= 100;
      height *= 100;
      let style_string = `<style>.node_container {width:${width}%;height:${height}%;}</style>`;
      $("head").append(style_string);
      console.log([width,height,]);
      for (let [index,node] of treeCoordinates.slice(1)) {
        let [x,y] = node.map(function (x) {return x*100});
        console.log(`Node : ${[x,y]}`);
        let style_spec =
          `
            top:${x}%;
            left:${y}%;
          `
        let node_html = `<div id="${index}" class="node_container" style="${style_spec}">${index}</div>`;
        $("#treeContainer").append(node_html);
      }
    }

    function decorateNodesSister() {
      $(".node_container").each(function (index,node) {
        let header_element = `<h5 class="node_header">Cluster ${index}</h5>`;
        node.innerHTML = header_element;
        node.innerHTML += `<a href="./${index}/cluster_summary_template_js.html"><img class="sister_map" src="./${index}/sister_map.png"/></a>`;
      });
    }

    function decorateNodesScore() {
      $(".node_container").each(function (index,node) {
        let header_element = `<h5 class="node_header">Cluster ${index}</h5>`;
        node.innerHTML = header_element;
        node.innerHTML += `<a href="./${index}/cluster_summary_template_js.html"><img class="score_map" src="./${index}/score_map.png"/></a>`;
      });
    }

    function insertConnections() {
      console.log(connections);
      let connection_string = "";
      for (c of connections) {
        let [y,x,cy,cx,t] = c.map(function (x){return 100*x});
        let coordinate_spec =
        `
        x1="${x}%"
        y1="${y}%"
        x2="${cx}%"
        y2="${cy}%"
        `;
        // let line_html = `<line class="connection" ${coordinate_spec}></line>`;
        let style_spec =
        `
        stroke-width:${t/10000}px;
        `;
        let line_html = `<line class="connection" ${coordinate_spec} style="${style_spec}"></line>`;
        connection_string = connection_string + line_html;
        // $("#lineContainer").append(line_html);

      }
      let svg_string = `<svg id="lineContainer" height="100%" width="100%" style="position:absolute;">${connection_string}</svg>`;
      $("#treeContainer").append(svg_string);
    }


  </script>
</head>
<body>
  <script>
    let summaries = {};
  </script>
  <div id="treeContainer">
  </div>
  <div class="decoration_type">
      <h1> Switch Node Summary </h1>
      <button class="score_switch" onclick="decorateNodesScore()"> Sample Frequency </button>
      <button class="sister_switch" onclick="decorateNodesSister()"> Sister Scores </button>
      <button class="feature_switch"> Changed Features </button>
  </div>
</body>
