<head>
  <style>
    #treeContainer {
      height:2000px;
      width:3000px;
      position:absolute;
      min-width:100%;
    }
    .node_container {
      z-index:1;
      background: white;
      opacity: 1;
      border: 1px solid gray;
      overflow:auto;
      position:absolute;
      width:300px;
    }
    .node_header{
      float:left;
      position:absolute;
      padding:3%;
      width:10%;
      height:84%;
      writing-mode:vertical-rl;
      margin:auto;
      text-align:center;
      transform:rotate(180deg);
    }

    .connection {
      stroke:black;
      z-index:-1;
    }
    .sister_map {
      float:right;
      margin:auto;
      height:100%;
      max-width:84%;
    }
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $(document).ready(
      function() {
        insertNodes();
        insertConnections();
        decorateNodes();
      });

    function insertNodes() {
      console.log(treeCoordinates);
      for (let [index,node] of treeCoordinates) {
        let [top,left,height,width] = node.map(function (x) {return x*100});
        console.log(`Node : ${[top,left,height,width]}`);
        let style_spec =
          `
            top:${top}%;
            left:${left}%;
            width:${width}%;
            height:${height}%;
          `
          // `
          //   top:${top}%;
          //   left:${left}%;
          //   max-width:${width}%;
          // `
          // `
          //   top:${top}%;
          //   left:${left}%;
          // `
          // `
          //   top:${top}%;
          //   left:${left}%;
          //   max-height:${height}%;
          //   max-width:${width}%;
          // `

        let node_html = `<div id="${index}" class="node_container" style="${style_spec}">${index}</div>`;
        $("#treeContainer").append(node_html);
      }
    }

    function decorateNodes() {
      $(".node_container").each(function (index,node) {
        let header_element = `<h5 class="node_header">Cluster ${index}</h5>`;
        node.innerHTML = header_element;
        node.innerHTML += `<img class="sister_map" src="./${index}/sister_map.png"/>`;
      });
    }

    function insertConnections() {
      console.log(connections);
      let connection_string = "";
      for (c of connections) {
        let [y,x,cy,cx,t] = c.map(function (x){return 100*x});
        let coordinate_spec =
        `
        x1="${x}%"
        y1="${y}%"
        x2="${cx}%"
        y2="${cy}%"
        `;
        // let line_html = `<line class="connection" ${coordinate_spec}></line>`;
        let style_spec =
        `
        stroke-width:${t/10000}px;
        `;
        let line_html = `<line class="connection" ${coordinate_spec} style="${style_spec}"></line>`;
        connection_string = connection_string + line_html;
        // $("#lineContainer").append(line_html);

      }
      let svg_string = `<svg id="lineContainer" height="100%" width="100%" style="position:absolute;">${connection_string}</svg>`;
      $("#treeContainer").append(svg_string);
    }


  </script>
</head>
<body>
  <script>
    let summaries = {};
  </script>
  <div id="treeContainer">
  </div>
</body>
